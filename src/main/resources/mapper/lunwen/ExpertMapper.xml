<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 
	namespace：必须与对应的接口全类名一致
	id:必须与对应接口的某个对应的方法名一致
 -->
<mapper namespace="com.sgcc.bg.lunwen.mapper.ExpertMapper">

    <select id="expertList" resultType="java.util.Map">
        SELECT a.* FROM (
            SELECT b.UUID AS id,
            b.NAME AS name,
            b.ADDRESS AS address,
            b.UNIT_NAME AS unitName,
            b.UNIT_NATURE AS unitNature,
            b.POSITION AS positton,
            b.RESEARCH_DIRECTION AS researchDirection,
            b.FIELD AS field,
            b.PHONE AS phone,
            b.EMAIL AS email,
            b.MATCH_STATUS AS matchStatus,
            ROWNUM AS ROWNO
            FROM BG_LW_SPECIALIST b
            WHERE b.VALID = '1'
            <if test="name != null and name != ''">
                AND b.NAME LIKE '%'||#{name}||'%'
            </if>
            <if test="researchDirection != null and researchDirection != ''">
                AND b.RESEARCH_DIRECTION LIKE '%'||#{researchDirection}||'%'
            </if>
            <if test="unitName != null and unitName != ''">
                AND b.UNIT_NAME LIKE '%'||#{unitName}||'%'
            </if>
            <if test="field != null and field !=''">
                AND b.FIELD LIKE '%'||#{field}||'%'
            </if>
            <if test="matchStatus != null and matchStatus != ''">
                AND b.MATCH_STATUS LIKE '%'||#{matchStatus}||'%'
            </if>
            AND #{end} >= ROWNUM
        ) a WHERE a.ROWNO > #{start}
    </select>

    <select id="lwSpecialist" resultType="java.util.Map">
        SELECT UUID AS id,
            NAME AS name,
            ADDRESS AS address,
            UNIT_NAME AS unitName,
            UNIT_NATURE AS unitNature,
            POSITION AS positton,
            RESEARCH_DIRECTION AS researchDirection,
            FIELD AS field,
            PHONE AS phone,
            EMAIL AS email,
            MATCH_STATUS AS matchStatus
            FROM BG_LW_SPECIALIST
            WHERE VALID = '1'
            AND UUID=#{id,jdbcType=VARCHAR}
    </select>

    <insert id="insertExpert" parameterType="com.sgcc.bg.lunwen.bean.LwSpecialist">
        INSERT INTO BG_LW_SPECIALIST (
            UUID,
            NAME,
            ADDRESS,
            UNIT_NAME,
            UNIT_NATURE,
            POSITION,
            RESEARCH_DIRECTION,
            FIELD,
            PHONE,
            EMAIL,
            MATCH_STATUS,
            CREATE_USER,
            CREATE_TIME,
            UPDATE_USER,
            UPDATE_TIME,
            VALID
        )VALUES(
            #{uuid,jdbcType=VARCHAR},
            #{name,jdbcType=VARCHAR},
            #{address,jdbcType=VARCHAR},
            #{unitName,jdbcType=VARCHAR},
            #{unitNature,jdbcType=VARCHAR},
            #{position,jdbcType=VARCHAR},
            #{researchDirection,jdbcType=VARCHAR},
            #{field,jdbcType=VARCHAR},
            #{phone,jdbcType=VARCHAR},
            #{email,jdbcType=VARCHAR},
            #{matchStatus,jdbcType=VARCHAR},
            #{createUser,jdbcType=VARCHAR},
            #{createTime,jdbcType=TIMESTAMP},
            #{updateUser,jdbcType=VARCHAR},
            #{updateTime,jdbcType=TIMESTAMP},
            #{valid,jdbcType=VARCHAR}
        )
    </insert>

    <update id="updateExpert" parameterType="com.sgcc.bg.lunwen.bean.LwSpecialist">
        UPDATE BG_LW_SPECIALIST SET
        <if test="name != null and name != ''">
            NAME  = #{name,jdbcType=VARCHAR},
        </if>
        <if test="address != null and address!=''">
            ADDRESS = #{address,jdbcType=VARCHAR},
        </if>
        <if test="unitName!=null and unitName!=''">
            UNIT_NAME = #{unitName,jdbcType=VARCHAR},
        </if>
        <if test="unitNature">
            UNIT_NATURE = #{unitNature,jdbcType=VARCHAR},
        </if>
        <if test="position != null and position != ''">
            POSITION = #{position,jdbcType=VARCHAR},
        </if>
        <if test="researchDirection != null and researchDirection != ''">
            RESEARCH_DIRECTION = #{researchDirection,jdbcType=VARCHAR},
        </if>
        <if test="field != null and field != ''">
            FIELD = #{field,jdbcType=VARCHAR},
        </if>
        <if test="phone !=null and phone != ''">
            PHONE = #{phone,jdbcType=VARCHAR},
        </if>
        <if test="email != null and email !=''">
            EMAIL = #{email,jdbcType=VARCHAR},
        </if>
        <if test="matchStatus != null and matchStatus != ''">
            MATCH_STATUS = #{matchStatus,jdbcType=VARCHAR},
        </if>
        <if test="createUser != null and createUser != ''">
            CREATE_USER = #{createUser,jdbcType=VARCHAR},
        </if>
        <if test="createTime != null and createTime != ''">
            UPDATE_USER = #{createTime,jdbcType=TIMESTAMP},
        </if>
        <if test="updateUser != null and updateUser != ''">
            CREATE_TIME = #{updateUser,jdbcType=VARCHAR},
        </if>
        <if test="updateTime != null and updateTime != ''">
            UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
        </if>
        <if test="valid != null and valid != ''">
            VALID = #{valid,jdbcType=VARCHAR}
        </if>
        WHERE UUID = #{id,,jdbcType=VARCHAR}
    </update>
</mapper>